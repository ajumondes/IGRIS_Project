{% extends "base.html" %}{% block content %}<h2>Behavioral Enrollment</h2><p>Please type the following paragraph into the text box below. Your unique typing rhythm will be recorded to create your profile.</p><div class="card bg-light my-3"><div class="card-body fst-italic">The quick brown fox jumps over the lazy dog. This sentence contains all letters of the English alphabet. Repetition helps build a more accurate profile. A biometric signature is created from the way you interact with the keyboard.</div></div><textarea id="enrollmentText" class="form-control" rows="6" placeholder="Start typing here..."></textarea><button id="submitBtn" class="btn btn-primary mt-3">Submit Enrollment Data</button><script>const enrollmentText=document.getElementById("enrollmentText"),submitBtn=document.getElementById("submitBtn");let typingEvents=[];enrollmentText.addEventListener("keydown",e=>{1<e.key.length||typingEvents.push({key:e.key,action:"keydown",timestamp:e.timeStamp})}),enrollmentText.addEventListener("keyup",e=>{1<e.key.length||typingEvents.push({key:e.key,action:"keyup",timestamp:e.timeStamp})}),submitBtn.addEventListener("click",()=>{50>typingEvents.length?alert("Please type more to create a reliable profile."):fetch("{{ url_for('api_enroll') }}",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(typingEvents)}).then(e=>{if(!e.ok)throw new Error("Server responded with an error!");return e.json()}).then(e=>{alert(e.message),"success"===e.status&&(window.location.href="{{ url_for('home') }}")}).catch(e=>{console.error("Error:",e),alert("An error occurred while submitting data. Check the console for details.")})});</script>{% endblock %}